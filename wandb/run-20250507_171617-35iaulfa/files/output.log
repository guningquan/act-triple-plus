Found 80 hdf5 files


Data from: ['/home/robot/Dataset_and_Checkpoint/dataset/zip_tie_random']
- Train on [79] episodes
- Test on [1] episodes


Found 80 hdf5 files
Norm stats from: ['/home/robot/Dataset_and_Checkpoint/dataset/zip_tie_random']
Initializing transformations
Initializing transformations
Augment images: False, train_num_workers: 2, val_num_workers: 2
/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
camera_name cam_left_wrist
camera_name cam_right_wrist
Use VQ: False, None, None
******************************************************************************************************************************************************
number of parameters: 117.43M
KL Weight 10
  0%|                                                                                                                                                                  | 0/100001 [00:00<?, ?it/s]
Validating
img.shape is tensor([[[[0.5098, 0.4941, 0.4824,  ..., 0.2667, 0.2588, 0.2471],
          [0.4902, 0.4784, 0.4706,  ..., 0.2706, 0.2627, 0.2549],
          [0.4745, 0.4667, 0.4588,  ..., 0.2706, 0.2627, 0.2588],
          ...,
          [0.1922, 0.1882, 0.1843,  ..., 0.2667, 0.2627, 0.2588],
          [0.2078, 0.2039, 0.2000,  ..., 0.2196, 0.2196, 0.2196],
          [0.2157, 0.2157, 0.2078,  ..., 0.1882, 0.1882, 0.1882]],

         [[0.5098, 0.4941, 0.4824,  ..., 0.2667, 0.2588, 0.2471],
          [0.4902, 0.4784, 0.4706,  ..., 0.2706, 0.2627, 0.2549],
          [0.4745, 0.4667, 0.4588,  ..., 0.2706, 0.2627, 0.2588],
          ...,
          [0.1961, 0.1922, 0.1882,  ..., 0.2588, 0.2549, 0.2510],
          [0.2118, 0.2078, 0.2039,  ..., 0.2118, 0.2118, 0.2118],
          [0.2196, 0.2196, 0.2118,  ..., 0.1804, 0.1804, 0.1804]],

         [[0.5098, 0.4941, 0.4824,  ..., 0.2667, 0.2588, 0.2471],
          [0.4902, 0.4784, 0.4706,  ..., 0.2706, 0.2627, 0.2549],
          [0.4745, 0.4667, 0.4588,  ..., 0.2706, 0.2627, 0.2588],
          ...,
          [0.1804, 0.1765, 0.1725,  ..., 0.2275, 0.2235, 0.2196],
          [0.1961, 0.1922, 0.1882,  ..., 0.1804, 0.1804, 0.1804],
          [0.2039, 0.2039, 0.1961,  ..., 0.1490, 0.1490, 0.1490]]],


        [[[0.6039, 0.6039, 0.6039,  ..., 0.4157, 0.4118, 0.4078],
          [0.6039, 0.6039, 0.6039,  ..., 0.4275, 0.4235, 0.4275],
          [0.6039, 0.6039, 0.6039,  ..., 0.4392, 0.4392, 0.4431],
          ...,
          [0.1569, 0.1569, 0.1569,  ..., 0.2157, 0.2118, 0.2078],
          [0.1569, 0.1569, 0.1569,  ..., 0.1843, 0.1804, 0.1804],
          [0.1569, 0.1569, 0.1569,  ..., 0.1608, 0.1608, 0.1608]],

         [[0.6039, 0.6039, 0.6039,  ..., 0.4157, 0.4118, 0.4078],
          [0.6039, 0.6039, 0.6039,  ..., 0.4275, 0.4235, 0.4275],
          [0.6039, 0.6039, 0.6039,  ..., 0.4392, 0.4392, 0.4431],
          ...,
          [0.1608, 0.1608, 0.1608,  ..., 0.2078, 0.2039, 0.2000],
          [0.1608, 0.1608, 0.1608,  ..., 0.1765, 0.1725, 0.1725],
          [0.1608, 0.1608, 0.1608,  ..., 0.1529, 0.1529, 0.1529]],

         [[0.6039, 0.6039, 0.6039,  ..., 0.4157, 0.4118, 0.4078],
          [0.6039, 0.6039, 0.6039,  ..., 0.4275, 0.4235, 0.4275],
          [0.6039, 0.6039, 0.6039,  ..., 0.4392, 0.4392, 0.4431],
          ...,
          [0.1451, 0.1451, 0.1451,  ..., 0.1765, 0.1725, 0.1686],
          [0.1451, 0.1451, 0.1451,  ..., 0.1451, 0.1412, 0.1412],
          [0.1451, 0.1451, 0.1451,  ..., 0.1216, 0.1216, 0.1216]]],


        [[[0.3843, 0.3765, 0.4039,  ..., 0.2784, 0.2745, 0.2706],
          [0.4196, 0.4039, 0.4157,  ..., 0.2824, 0.2745, 0.2745],
          [0.4549, 0.4275, 0.4235,  ..., 0.2824, 0.2784, 0.2745],
          ...,
          [0.1922, 0.1882, 0.1843,  ..., 0.2588, 0.2549, 0.2510],
          [0.2078, 0.2039, 0.2000,  ..., 0.2118, 0.2118, 0.2118],
          [0.2157, 0.2157, 0.2078,  ..., 0.1804, 0.1804, 0.1804]],

         [[0.3804, 0.3725, 0.4000,  ..., 0.2784, 0.2745, 0.2706],
          [0.4157, 0.4000, 0.4118,  ..., 0.2824, 0.2745, 0.2745],
          [0.4510, 0.4235, 0.4196,  ..., 0.2824, 0.2784, 0.2745],
          ...,
          [0.1922, 0.1882, 0.1843,  ..., 0.2510, 0.2471, 0.2431],
          [0.2078, 0.2039, 0.2000,  ..., 0.2039, 0.2039, 0.2039],
          [0.2157, 0.2157, 0.2078,  ..., 0.1725, 0.1725, 0.1725]],

         [[0.3961, 0.3882, 0.4157,  ..., 0.2784, 0.2745, 0.2706],
          [0.4314, 0.4157, 0.4275,  ..., 0.2824, 0.2745, 0.2745],
          [0.4667, 0.4392, 0.4353,  ..., 0.2824, 0.2784, 0.2745],
          ...,
          [0.1922, 0.1882, 0.1843,  ..., 0.2196, 0.2157, 0.2118],
          [0.2078, 0.2039, 0.2000,  ..., 0.1725, 0.1725, 0.1725],
          [0.2157, 0.2157, 0.2078,  ..., 0.1412, 0.1412, 0.1412]]],


        [[[0.1843, 0.2275, 0.2471,  ..., 0.0784, 0.0824, 0.0863],
          [0.1765, 0.2118, 0.2314,  ..., 0.0784, 0.0824, 0.0902],
          [0.1725, 0.2039, 0.2118,  ..., 0.0784, 0.0824, 0.0902],
          ...,
          [0.2431, 0.2510, 0.2627,  ..., 0.1059, 0.1059, 0.1059],
          [0.2471, 0.2549, 0.2667,  ..., 0.1098, 0.1098, 0.1098],
          [0.2471, 0.2549, 0.2667,  ..., 0.1098, 0.1098, 0.1098]],

         [[0.2039, 0.2431, 0.2588,  ..., 0.0902, 0.0980, 0.1020],
          [0.1961, 0.2275, 0.2471,  ..., 0.0902, 0.0980, 0.1059],
          [0.1961, 0.2196, 0.2275,  ..., 0.0902, 0.0980, 0.1059],
          ...,
          [0.2627, 0.2706, 0.2824,  ..., 0.1059, 0.1059, 0.1059],
          [0.2667, 0.2745, 0.2863,  ..., 0.1098, 0.1098, 0.1098],
          [0.2667, 0.2745, 0.2863,  ..., 0.1098, 0.1098, 0.1098]],

         [[0.3569, 0.3804, 0.3804,  ..., 0.1059, 0.1176, 0.1216],
          [0.3490, 0.3647, 0.3608,  ..., 0.1059, 0.1176, 0.1255],
          [0.3412, 0.3569, 0.3412,  ..., 0.1059, 0.1176, 0.1255],
          ...,
          [0.2588, 0.2667, 0.2784,  ..., 0.1059, 0.1059, 0.1059],
          [0.2627, 0.2706, 0.2824,  ..., 0.1098, 0.1098, 0.1098],
          [0.2627, 0.2706, 0.2824,  ..., 0.1098, 0.1098, 0.1098]]]],
       device='cuda:0')
Traceback (most recent call last):
  File "imitate_episodes_multi_gpu.py", line 904, in <module>
    main(vars(parser.parse_args()))
  File "imitate_episodes_multi_gpu.py", line 233, in main
    best_ckpt_info = train_bc(train_dataloader, val_dataloader, config, policy)
  File "imitate_episodes_multi_gpu.py", line 797, in train_bc
    forward_dict = forward_pass(data, policy)
  File "imitate_episodes_multi_gpu.py", line 744, in forward_pass
    return policy(qpos_data, image_data, action_data, is_pad) # TODO remove None
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/policy.py", line 343, in __call__
    a_hat, is_pad_hat, (mu, logvar), probs, binaries = self.model(qpos, image, env_state, actions, is_pad, vq_sample)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/detr_vae.py", line 164, in forward
    features, pos = self.backbones[cam_id](image[:, cam_id])
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 150, in forward
    xs = self[0](tensor_list)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 200, in forward
    return self.backbone(normals_resized)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 121, in forward
    xs = self.body(tensor)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torchvision/models/_utils.py", line 69, in forward
    x = module(x)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [64, 3, 7, 7], expected input[4, 8, 480, 640] to have 3 channels, but got 8 channels instead
Traceback (most recent call last):
  File "imitate_episodes_multi_gpu.py", line 904, in <module>
    main(vars(parser.parse_args()))
  File "imitate_episodes_multi_gpu.py", line 233, in main
    best_ckpt_info = train_bc(train_dataloader, val_dataloader, config, policy)
  File "imitate_episodes_multi_gpu.py", line 797, in train_bc
    forward_dict = forward_pass(data, policy)
  File "imitate_episodes_multi_gpu.py", line 744, in forward_pass
    return policy(qpos_data, image_data, action_data, is_pad) # TODO remove None
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/policy.py", line 343, in __call__
    a_hat, is_pad_hat, (mu, logvar), probs, binaries = self.model(qpos, image, env_state, actions, is_pad, vq_sample)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/detr_vae.py", line 164, in forward
    features, pos = self.backbones[cam_id](image[:, cam_id])
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 150, in forward
    xs = self[0](tensor_list)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 200, in forward
    return self.backbone(normals_resized)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/robot/Programs_Codes/aloha_related/act-triple-plus/detr/models/backbone.py", line 121, in forward
    xs = self.body(tensor)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torchvision/models/_utils.py", line 69, in forward
    x = module(x)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/ubuntu20/miniforge3/envs/aloha/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [64, 3, 7, 7], expected input[4, 8, 480, 640] to have 3 channels, but got 8 channels instead
